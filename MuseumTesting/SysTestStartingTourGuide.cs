using ReservationSystem;

namespace MuseumTesting
{
    [TestClass]
    public class SysTestStartingTour
    {
        [TestCleanup]
        public void CleanUp()
        {
            try
            {
                File.Delete(TourTools.JsonFilePath);
            }
            catch (DirectoryNotFoundException)
            {

            }
        }

        [TestMethod]
        public void TestGuideStartTourWhileEveryonePresent()
        {
            // Arrange
            string tourChoice = "1";
            string visitorTicketCode = "1234567890";
            FakeWorld world = new()
            {
                Today = new DateTime(2024, 6, 1),
                Now = new DateTime(2024, 6, 1),
                Files =
                {
                    {"./JSON-Files/OnlineTickets.json", "[\"1234567890\"]"},
                    {"./JSON-Files/TourSettings.json","{\"StartTime\": \"9:00:00\",\"EndTime\": \"16:40:00\",\"Duration\": 40,\"MaxCapacity\": 13}"},
                    {"./JSON-Files/GuideAssignments.json","[{\"GuideName\": \"John Doe\",\"Tours\": [{\"StartTime\": \"11:00 AM\"},{\"StartTime\": \"12:15 PM\"},{\"StartTime\": \"01:30 PM\"},{\"StartTime\": \"02:45 PM\"},{\"StartTime\": \"04:00 PM\"}]},{\"GuideName\": \"Alice Johnson\",\"Tours\": [{\"StartTime\": \"11:15 AM\"},{\"StartTime\": \"12:30 PM\"},{\"StartTime\": \"01:45 PM\"},{\"StartTime\": \"03:00 PM\"},{\"StartTime\": \"04:15 PM\"}]},{\"GuideName\": \"Steve Brown\",\"Tours\": [{\"StartTime\": \"11:30 AM\"},{\"StartTime\": \"12:45 PM\"},{\"StartTime\": \"02:00 PM\"},{\"StartTime\": \"03:15 PM\"}]},{\"GuideName\": \"Mary Lee\",\"Tours\": [{\"StartTime\": \"11:45 AM\"},{\"StartTime\": \"01:00 PM\"},{\"StartTime\": \"02:15 PM\"},{\"StartTime\": \"03:30 PM\"}]},{\"GuideName\": \"Tom Clark\",\"Tours\": [{\"StartTime\": \"12:00 PM\"},{\"StartTime\": \"01:15 PM\"},{\"StartTime\": \"02:30 PM\"},{\"StartTime\": \"03:45 PM\"}]}]"},
                    {"./JSON-Files/Tours-20240601.json","[{\"TourId\":\"a85e88d2-b20f-4320-89e6-251b1d78d633\",\"StartTime\":\"2024-06-01T09:00:00+02:00\",\"EndTime\":\"2024-06-01T09:40:00+02:00\",\"Duration\":40,\"MaxCapacity\":13,\"ExpectedVisitors\":[],\"PresentVisitors\":[],\"Started\":false,\"Deleted\":false,\"AssignedGuide\":{\"GuideId\":\"6c8cb11c-cf42-4606-8778-2831c5c5fda8\",\"Name\":\"John Doe\",\"Password\":\"11\"}},{\"TourId\":\"7cef0248-3d1d-46ac-b65a-b56cc9233905\",\"StartTime\":\"2024-06-01T09:20:00+02:00\",\"EndTime\":\"2024-06-01T10:00:00+02:00\",\"Duration\":40,\"MaxCapacity\":13,\"ExpectedVisitors\":[],\"PresentVisitors\":[],\"Started\":false,\"Deleted\":false,\"AssignedGuide\":{\"GuideId\":\"2d739229-6220-4d32-84c1-c18a812f2774\",\"Name\":\"Alice Johnson\",\"Password\":\"22\"}},{\"TourId\":\"fe2cf6df-61c5-4f48-b98c-26b3bc638320\",\"StartTime\":\"2024-06-01T09:40:00+02:00\",\"EndTime\":\"2024-06-01T10:20:00+02:00\",\"Duration\":40,\"MaxCapacity\":13,\"ExpectedVisitors\":[],\"PresentVisitors\":[],\"Started\":false,\"Deleted\":false,\"AssignedGuide\":{\"GuideId\":\"1cae7c8d-bec3-416d-a4a3-3023ff0bc402\",\"Name\":\"Steve Brown\",\"Password\":\"33\"}},{\"TourId\":\"8482a237-e23b-4923-b176-21e741e0c7c1\",\"StartTime\":\"2024-06-01T10:00:00+02:00\",\"EndTime\":\"2024-06-01T10:40:00+02:00\",\"Duration\":40,\"MaxCapacity\":13,\"ExpectedVisitors\":[],\"PresentVisitors\":[],\"Started\":false,\"Deleted\":false,\"AssignedGuide\":{\"GuideId\":\"6c8cb11c-cf42-4606-8778-2831c5c5fda8\",\"Name\":\"John Doe\",\"Password\":\"11\"}},{\"TourId\":\"3ae6d6c1-355a-405b-ba7e-aee107bb5a0e\",\"StartTime\":\"2024-06-01T10:20:00+02:00\",\"EndTime\":\"2024-06-01T11:00:00+02:00\",\"Duration\":40,\"MaxCapacity\":13,\"ExpectedVisitors\":[],\"PresentVisitors\":[],\"Started\":false,\"Deleted\":false,\"AssignedGuide\":{\"GuideId\":\"2d739229-6220-4d32-84c1-c18a812f2774\",\"Name\":\"Alice Johnson\",\"Password\":\"22\"}},{\"TourId\":\"fc59151c-2343-4667-b606-08932596354c\",\"StartTime\":\"2024-06-01T10:40:00+02:00\",\"EndTime\":\"2024-06-01T11:20:00+02:00\",\"Duration\":40,\"MaxCapacity\":13,\"ExpectedVisitors\":[],\"PresentVisitors\":[],\"Started\":false,\"Deleted\":false,\"AssignedGuide\":{\"GuideId\":\"1cae7c8d-bec3-416d-a4a3-3023ff0bc402\",\"Name\":\"Steve Brown\",\"Password\":\"33\"}},{\"TourId\":\"a36df75a-15ea-43d4-8fee-6583a800a809\",\"StartTime\":\"2024-06-01T11:00:00+02:00\",\"EndTime\":\"2024-06-01T11:40:00+02:00\",\"Duration\":40,\"MaxCapacity\":13,\"ExpectedVisitors\":[],\"PresentVisitors\":[],\"Started\":false,\"Deleted\":false,\"AssignedGuide\":{\"GuideId\":\"6c8cb11c-cf42-4606-8778-2831c5c5fda8\",\"Name\":\"John Doe\",\"Password\":\"11\"}},{\"TourId\":\"3370f7cd-e6e4-483d-bb23-e6fe37198d8a\",\"StartTime\":\"2024-06-01T11:20:00+02:00\",\"EndTime\":\"2024-06-01T12:00:00+02:00\",\"Duration\":40,\"MaxCapacity\":13,\"ExpectedVisitors\":[],\"PresentVisitors\":[],\"Started\":false,\"Deleted\":false,\"AssignedGuide\":{\"GuideId\":\"2d739229-6220-4d32-84c1-c18a812f2774\",\"Name\":\"Alice Johnson\",\"Password\":\"22\"}},{\"TourId\":\"f3e32847-5736-4f3a-8c5a-e0b01e051dcd\",\"StartTime\":\"2024-06-01T11:40:00+02:00\",\"EndTime\":\"2024-06-01T12:20:00+02:00\",\"Duration\":40,\"MaxCapacity\":13,\"ExpectedVisitors\":[],\"PresentVisitors\":[],\"Started\":false,\"Deleted\":false,\"AssignedGuide\":{\"GuideId\":\"1cae7c8d-bec3-416d-a4a3-3023ff0bc402\",\"Name\":\"Steve Brown\",\"Password\":\"33\"}},{\"TourId\":\"fbea4438-1bc9-4cda-bdc5-e244f7a23492\",\"StartTime\":\"2024-06-01T12:00:00+02:00\",\"EndTime\":\"2024-06-01T12:40:00+02:00\",\"Duration\":40,\"MaxCapacity\":13,\"ExpectedVisitors\":[],\"PresentVisitors\":[],\"Started\":false,\"Deleted\":false,\"AssignedGuide\":{\"GuideId\":\"6c8cb11c-cf42-4606-8778-2831c5c5fda8\",\"Name\":\"John Doe\",\"Password\":\"11\"}},{\"TourId\":\"464a5606-78f0-463e-97b7-7cf99a53fe73\",\"StartTime\":\"2024-06-01T12:20:00+02:00\",\"EndTime\":\"2024-06-01T13:00:00+02:00\",\"Duration\":40,\"MaxCapacity\":13,\"ExpectedVisitors\":[],\"PresentVisitors\":[],\"Started\":false,\"Deleted\":false,\"AssignedGuide\":{\"GuideId\":\"2d739229-6220-4d32-84c1-c18a812f2774\",\"Name\":\"Alice Johnson\",\"Password\":\"22\"}},{\"TourId\":\"33cd523f-0e5f-472e-ad59-eef5e687ca2b\",\"StartTime\":\"2024-06-01T12:40:00+02:00\",\"EndTime\":\"2024-06-01T13:20:00+02:00\",\"Duration\":40,\"MaxCapacity\":13,\"ExpectedVisitors\":[],\"PresentVisitors\":[],\"Started\":false,\"Deleted\":false,\"AssignedGuide\":{\"GuideId\":\"1cae7c8d-bec3-416d-a4a3-3023ff0bc402\",\"Name\":\"Steve Brown\",\"Password\":\"33\"}},{\"TourId\":\"aa3c5563-9a09-474a-afde-de648ec34b3e\",\"StartTime\":\"2024-06-01T13:00:00+02:00\",\"EndTime\":\"2024-06-01T13:40:00+02:00\",\"Duration\":40,\"MaxCapacity\":13,\"ExpectedVisitors\":[],\"PresentVisitors\":[],\"Started\":false,\"Deleted\":false,\"AssignedGuide\":{\"GuideId\":\"6c8cb11c-cf42-4606-8778-2831c5c5fda8\",\"Name\":\"John Doe\",\"Password\":\"11\"}},{\"TourId\":\"885f72c1-49ce-4b2c-a1cc-fc4221b1571c\",\"StartTime\":\"2024-06-01T13:20:00+02:00\",\"EndTime\":\"2024-06-01T14:00:00+02:00\",\"Duration\":40,\"MaxCapacity\":13,\"ExpectedVisitors\":[],\"PresentVisitors\":[],\"Started\":false,\"Deleted\":false,\"AssignedGuide\":{\"GuideId\":\"2d739229-6220-4d32-84c1-c18a812f2774\",\"Name\":\"Alice Johnson\",\"Password\":\"22\"}},{\"TourId\":\"2dcf2558-a0ac-4e90-84ca-b06e26a11882\",\"StartTime\":\"2024-06-01T13:40:00+02:00\",\"EndTime\":\"2024-06-01T14:20:00+02:00\",\"Duration\":40,\"MaxCapacity\":13,\"ExpectedVisitors\":[],\"PresentVisitors\":[],\"Started\":false,\"Deleted\":false,\"AssignedGuide\":{\"GuideId\":\"1cae7c8d-bec3-416d-a4a3-3023ff0bc402\",\"Name\":\"Steve Brown\",\"Password\":\"33\"}},{\"TourId\":\"5bb98a5c-9c23-41be-947f-b0dc0af807bf\",\"StartTime\":\"2024-06-01T14:00:00+02:00\",\"EndTime\":\"2024-06-01T14:40:00+02:00\",\"Duration\":40,\"MaxCapacity\":13,\"ExpectedVisitors\":[],\"PresentVisitors\":[],\"Started\":false,\"Deleted\":false,\"AssignedGuide\":{\"GuideId\":\"6c8cb11c-cf42-4606-8778-2831c5c5fda8\",\"Name\":\"John Doe\",\"Password\":\"11\"}},{\"TourId\":\"89d717b6-59b4-47ff-a9a9-378061620585\",\"StartTime\":\"2024-06-01T14:20:00+02:00\",\"EndTime\":\"2024-06-01T15:00:00+02:00\",\"Duration\":40,\"MaxCapacity\":13,\"ExpectedVisitors\":[],\"PresentVisitors\":[],\"Started\":false,\"Deleted\":false,\"AssignedGuide\":{\"GuideId\":\"2d739229-6220-4d32-84c1-c18a812f2774\",\"Name\":\"Alice Johnson\",\"Password\":\"22\"}},{\"TourId\":\"be7a7338-6c94-424b-b5ef-241fb4611f81\",\"StartTime\":\"2024-06-01T14:40:00+02:00\",\"EndTime\":\"2024-06-01T15:20:00+02:00\",\"Duration\":40,\"MaxCapacity\":13,\"ExpectedVisitors\":[],\"PresentVisitors\":[],\"Started\":false,\"Deleted\":false,\"AssignedGuide\":{\"GuideId\":\"1cae7c8d-bec3-416d-a4a3-3023ff0bc402\",\"Name\":\"Steve Brown\",\"Password\":\"33\"}},{\"TourId\":\"d0cc3d88-5151-4683-81c1-6117b9b87cfa\",\"StartTime\":\"2024-06-01T15:00:00+02:00\",\"EndTime\":\"2024-06-01T15:40:00+02:00\",\"Duration\":40,\"MaxCapacity\":13,\"ExpectedVisitors\":[],\"PresentVisitors\":[],\"Started\":false,\"Deleted\":false,\"AssignedGuide\":{\"GuideId\":\"6c8cb11c-cf42-4606-8778-2831c5c5fda8\",\"Name\":\"John Doe\",\"Password\":\"11\"}},{\"TourId\":\"d640545c-90a3-4ee7-a96a-bcb78b5918dc\",\"StartTime\":\"2024-06-01T15:20:00+02:00\",\"EndTime\":\"2024-06-01T16:00:00+02:00\",\"Duration\":40,\"MaxCapacity\":13,\"ExpectedVisitors\":[],\"PresentVisitors\":[],\"Started\":false,\"Deleted\":false,\"AssignedGuide\":{\"GuideId\":\"2d739229-6220-4d32-84c1-c18a812f2774\",\"Name\":\"Alice Johnson\",\"Password\":\"22\"}},{\"TourId\":\"1e9b600c-0cb8-4c92-831e-3af07e2a519e\",\"StartTime\":\"2024-06-01T15:40:00+02:00\",\"EndTime\":\"2024-06-01T16:20:00+02:00\",\"Duration\":40,\"MaxCapacity\":13,\"ExpectedVisitors\":[],\"PresentVisitors\":[],\"Started\":false,\"Deleted\":false,\"AssignedGuide\":{\"GuideId\":\"1cae7c8d-bec3-416d-a4a3-3023ff0bc402\",\"Name\":\"Steve Brown\",\"Password\":\"33\"}},{\"TourId\":\"e546ad40-4fb3-467b-a800-172373f80127\",\"StartTime\":\"2024-06-01T16:00:00+02:00\",\"EndTime\":\"2024-06-01T16:40:00+02:00\",\"Duration\":40,\"MaxCapacity\":13,\"ExpectedVisitors\":[],\"PresentVisitors\":[],\"Started\":false,\"Deleted\":false,\"AssignedGuide\":{\"GuideId\":\"6c8cb11c-cf42-4606-8778-2831c5c5fda8\",\"Name\":\"John Doe\",\"Password\":\"11\"}}]"}
                },
                LinesToRead = new()
                {
                    visitorTicketCode,tourChoice,"Enter,","GETMEOUT"
                }
            };
            Program.World = world;

            // Act
            Program.Main();
        }
    }
}